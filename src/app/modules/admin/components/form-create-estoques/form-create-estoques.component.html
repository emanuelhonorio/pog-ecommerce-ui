<form
  #formDir="ngForm"
  [formGroup]="estoqueForm"
  (ngSubmit)="onSubmit(formDir)"
>
  <!-- Field de Cor -->
  <div class="row">
    <div class="col-md-6 has-buttons">
      <mat-form-field appearance="outline">
        <mat-label>Escolha uma cor</mat-label>
        <mat-select formControlName="cor">
          <mat-option>Nenhuma</mat-option>
          <mat-option *ngFor="let cor of cores" [value]="cor.id">{{
            cor.nome
          }}</mat-option>
        </mat-select>
      </mat-form-field>
      <button
        mat-icon-button
        color="primary"
        type="button"
        [disabled]="loading"
        (click)="openDialog(dialogCor)"
      >
        <mat-icon color="primary">add</mat-icon>
      </button>
    </div>
  </div>

  <!-- Field de Tamanho -->
  <div class="row">
    <div class="col-md-6 has-buttons">
      <mat-form-field appearance="outline">
        <mat-label>Escolha um tamanho</mat-label>
        <mat-select formControlName="tamanho">
          <mat-option>Nenhum</mat-option>
          <mat-option *ngFor="let tamanho of tamanhos" [value]="tamanho.id">{{
            tamanho.nome
          }}</mat-option>
        </mat-select>
      </mat-form-field>
      <button
        mat-icon-button
        color="primary"
        type="button"
        [disabled]="loading"
        (click)="openDialog(dialogTamanho)"
      >
        <mat-icon color="primary">add</mat-icon>
      </button>
    </div>
  </div>

  <!-- Field de Quantidade em Estoque -->
  <div class="row">
    <div class="col-md-4">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Quantidade em estoque</mat-label>
        <input matInput type="number" formControlName="qtdEstoque" />
      </mat-form-field>
    </div>
  </div>

  <!-- Field de Valor -->
  <div class="row">
    <div class="col-md-4">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Acrescimo Valor</mat-label>
        <input matInput type="number" formControlName="acrescimoValor" />
      </mat-form-field>
    </div>
  </div>

  <!-- Button Submit -->
  <div class="mt-1">
    <button
      mat-flat-button
      color="primary"
      type="submit"
      [disabled]="estoqueForm.invalid || loading"
    >
      {{ loading ? "Salvando..." : "Salvar" }}
    </button>

    <button mat-button type="button" [disabled]="loading" (click)="initForm()">
      Cancelar
    </button>
  </div>
</form>

<ng-template #dialogCor>
  <h2 mat-dialog-title>Criar nova cor</h2>
  <mat-dialog-content class="mat-typography">
    <mat-form-field appearance="outline">
      <mat-label>Cor</mat-label>
      <input matInput type="url" [formControl]="corCtrl" />
    </mat-form-field>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button mat-dialog-close>Fechar</button>
    <button
      mat-button
      [mat-dialog-close]="true"
      [disabled]="corCtrl.invalid || loading"
      (click)="createCor()"
    >
      Criar
    </button>
  </mat-dialog-actions>
</ng-template>

<ng-template #dialogTamanho>
  <h2 mat-dialog-title>Criar novo tamanho</h2>
  <mat-dialog-content class="mat-typography">
    <mat-form-field appearance="outline">
      <mat-label>Tamanho</mat-label>
      <input matInput type="url" [formControl]="tamanhoCtrl" />
    </mat-form-field>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button mat-dialog-close>Fechar</button>
    <button
      mat-button
      [mat-dialog-close]="true"
      [disabled]="tamanhoCtrl.invalid || loading"
      (click)="createTamanho()"
    >
      Criar
    </button>
  </mat-dialog-actions>
</ng-template>
